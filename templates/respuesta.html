<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">

    <link rel="icon" type="image/png" sizes="32x32" href="../img/clipboard2-heart-fill.svg">
    <link rel="stylesheet" href="../css/respstyle.css">

    <title>Cuestionario | Responder cuestionario </title>
</head>

<body>

    <div class="cuestionario">
        <h1 id="title"></h1>
        <p id="descrip"></p>

        

        <table class="listitem">
            <tr>
                <th>1</th>
                <th>Obstructivo</th>
                <th><input type="radio" name="item1" value="1">
                    <input type="radio" name="item1" value="2">
                    <input type="radio" name="item1" value="3">
                    <input type="radio" name="item1" value="4">
                    <input type="radio" name="item1" value="5">
                    <input type="radio" name="item1" value="6">
                    <input type="radio" name="item1" value="7">
                </th>
                <th>Impulsor</th>
            </tr>
            <tr>
                <th>2</th>
                <th>Complicado</th>
                <th><input type="radio" name="item2" value="1">
                    <input type="radio" name="item2" value="2">
                    <input type="radio" name="item2" value="3">
                    <input type="radio" name="item2" value="4">
                    <input type="radio" name="item2" value="5">
                    <input type="radio" name="item2" value="6">
                    <input type="radio" name="item2" value="7">
                </th>
                <th>FÃ¡cil</th>
            </tr>
            <tr>
                <th>3</th>
                <th>Ineficiente</th>
                <th><input type="radio" name="item3" value="1">
                    <input type="radio" name="item3" value="2">
                    <input type="radio" name="item3" value="3">
                    <input type="radio" name="item3" value="4">
                    <input type="radio" name="item3" value="5">
                    <input type="radio" name="item3" value="6">
                    <input type="radio" name="item3" value="7">
                </th>
                <th>Eficiente</th>
            </tr>
            <tr>
                <th>4</th>
                <th>Confuso</th>
                <th><input type="radio" name="item4" value="1">
                    <input type="radio" name="item4" value="2">
                    <input type="radio" name="item4" value="3">
                    <input type="radio" name="item4" value="4">
                    <input type="radio" name="item4" value="5">
                    <input type="radio" name="item4" value="6">
                    <input type="radio" name="item4" value="7">
                </th>
                <th>Claro</th>
            </tr>
            <tr>
                <th>5</th>
                <th>Aburrido</th>
                <th><input type="radio" name="item5" value="1">
                    <input type="radio" name="item5" value="2">
                    <input type="radio" name="item5" value="3">
                    <input type="radio" name="item5" value="4">
                    <input type="radio" name="item5" value="5">
                    <input type="radio" name="item5" value="6">
                    <input type="radio" name="item5" value="7">
                </th>
                <th>Emocionante</th>
            </tr>
            <tr>
                <th>6</th>
                <th>No interesante</th>
                <th><input type="radio" name="item6" value="1">
                    <input type="radio" name="item6" value="2">
                    <input type="radio" name="item6" value="3">
                    <input type="radio" name="item6" value="4">
                    <input type="radio" name="item6" value="5">
                    <input type="radio" name="item6" value="6">
                    <input type="radio" name="item6" value="7">
                </th>
                <th>Interesante</th>
            </tr>
            <tr>
                <th>7</th>
                <th>Convencional</th>
                <th><input type="radio" name="item7" value="1">
                    <input type="radio" name="item7" value="2">
                    <input type="radio" name="item7" value="3">
                    <input type="radio" name="item7" value="4">
                    <input type="radio" name="item7" value="5">
                    <input type="radio" name="item7" value="6">
                    <input type="radio" name="item7" value="7">
                </th>
                <th>Original</th>
            </tr>
            <tr>
                <th>8</th>
                <th>Convencional</th>
                <th><input type="radio" name="item8" value="1">
                    <input type="radio" name="item8" value="2">
                    <input type="radio" name="item8" value="3">
                    <input type="radio" name="item8" value="4">
                    <input type="radio" name="item8" value="5">
                    <input type="radio" name="item8" value="6">
                    <input type="radio" name="item8" value="7">
                </th>
                <th>Novedoso</th>
            </tr>


        </table>

        <a href="./termina.html" class="pagterm">
            <button id="Envio" class="env" type="submit">Enviar Respuesta</button>
        </a>

        <script type="module">
            import { initializeApp } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-app.js";
            import { getDatabase, ref, set, get, child, update, remove, onValue } from "https://www.gstatic.com/firebasejs/9.8.1/firebase-database.js";

            const firebaseConfig = {
                apiKey: "AIzaSyBUtpFatRb8ubLIezntv_-aC5uqJ2ahAFw",
                authDomain: "ueqdatabase-26551.firebaseapp.com",
                databaseURL: "https://ueqdatabase-26551-default-rtdb.firebaseio.com",
                projectId: "ueqdatabase-26551",
                storageBucket: "ueqdatabase-26551.appspot.com",
                messagingSenderId: "275866539227",
                appId: "1:275866539227:web:d2ef1b9730c6a4863a28fe"
            };

            const app = initializeApp(firebaseConfig);
            const db = getDatabase();

            var genbtn = document.getElementById("Envio");
            

            var item1Res = document.getElementsByName("item1");
            var item2Res = document.getElementsByName("item2");
            var item3Res = document.getElementsByName("item3");
            var item4Res = document.getElementsByName("item4");
            var item5Res = document.getElementsByName("item5");
            var item6Res = document.getElementsByName("item6");
            var item7Res = document.getElementsByName("item7");
            var item8Res = document.getElementsByName("item8");
            var Pin;
             
            var Title = document.getElementById("title");
            var Descrip = document.getElementById("descrip");

            function getRes(item1Res) {
                for (var i = 0, length = item1Res.length; i < length; i++) {
                    if (item1Res[i].checked) {
                        return item1Res[i].value;
                    }
                }
            }

            function saveAnsw() {
                set(ref(db, "TemporalRes"), {
                    item1: getRes(item1Res),
                    item2: getRes(item2Res),
                    item3: getRes(item3Res),
                    item4: getRes(item4Res),
                    item5: getRes(item5Res),
                    item6: getRes(item6Res),
                    item7: getRes(item7Res),
                    item8: getRes(item8Res)
                });
            }
            genbtn.addEventListener('click', saveAnsw)


            function getPIN() {
                get(ref(db, "PINResp")).then((snapshot) => {
                    if (snapshot.exists()) {
                        Pin = snapshot.val().PIN;
                        getData(Pin);
                    }
                    else {
                        alert("Error al buscar el PIN");
                    }
                })
                    .catch((error) => {
                        alert("ERROR " + error);
                    });
            }
            window.onload = getPIN;


            function getData(PIN) {
                const dbref = ref(db);
                get(child(dbref, "Cuestionarios/" + Pin)).then((snapshot) => {
                    if (snapshot.exists()) {
                        document.getElementById('title').innerHTML = snapshot.val().Titulo;
                        document.getElementById('descrip').innerHTML = snapshot.val().Descrip;
                        if (snapshot.val().Type = "UeqShort") {
                            console.log("UEQSHORT");
                        }
                        else {
                            console.log("UEQ");
                        }
                    }
                    else {
                        document.getElementById('title').innerHTML = "Error: El cuestionario no existe, compruebe su PIN y vuelve a intentarlo";
                    }
                }).catch((error) => {
                    alert("ERROR " + error);
                });
            }

        </script>
    </div>

</body>




</html>